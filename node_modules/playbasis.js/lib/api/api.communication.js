'use strict';





module.exports=function(Playbasis){


var http=Playbasis.http;
var helpers=Playbasis.helpers;


var api=Playbasis.communicationApi={};













api.sendEmail=function(playerId,subject,message,templateId)
{
var obj={token:Playbasis.env.global.token,player_id:playerId,subject:subject,message:message,template_id:templateId};

return http.postJsonAsync(helpers.createApiUrl("Email/send"),obj);
};














api.sendEmailCoupon=function(playerId,refId,subject,message,templateId)
{
var obj={token:Playbasis.env.global.token,player_id:playerId,ref_id:refId,subject:subject,message:message,template_id:templateId};

return http.postJsonAsync(helpers.createApiUrl("Email/goods"),obj);
};













api.listRecentEmailSent=function(playerId,options)
{
var keys=["player_id","since"];
var dvalues=[playerId,null];

return http.getJsonAsync(helpers.createApiUrl("Email/recent")+helpers.appendAndJoinIfNotNullAsUrlParam2(keys,dvalues,options));
};







api.listEmailTemplate=function()
{
return http.getJsonAsync(helpers.createApiUrl("Email/template"));
};













api.getProcessedEmailTemplate=function(templateId,options)
{
var keys=["player_id"];
var dvalues=[null];

return http.getJsonAsync(helpers.createApiUrl("Email/template",templateId)+helpers.appendAndJoinIfNotNullAsUrlParam2(keys,dvalues,options));
};










api.sendSMS=function(playerId,message,templateId)
{
var obj={token:Playbasis.env.global.token,player_id:playerId,message:message,template_id:templateId};

return http.postJsonAsync(helpers.createApiUrl("Sms/send"),obj);
};









api.sendSMSCoupon=function(playerId,refId,message,templateId)
{
var obj={token:Playbasis.env.global.token,player_id:playerId,ref_id:refId,message:message,template_id:templateId};

return http.postJsonAsync(helpers.createApiUrl("Sms/goods"),obj);
};













api.listRecentSMSSent=function(playerId,options)
{
var keys=["player_id","since"];
var dvalues=[playerId,null];

return http.getJsonAsync(helpers.createApiUrl("Sms/recent")+helpers.appendAndJoinIfNotNullAsUrlParam2(keys,dvalues,options));
};







api.listSMSTemplate=function()
{
return http.getJsonAsync(helpers.createApiUrl("Sms/template"));
};













api.getProcessedSMSTemplate=function(templateId,options)
{
var keys=["player_id"];
var dvalues=[null];

return http.getJsonAsync(helpers.createApiUrl("Sms/template",templateId)+helpers.appendAndJoinIfNotNullAsUrlParam2(keys,dvalues,options));
};












api.registerDevice=function(playerId,deviceToken,deviceDescription,deviceName,osType)
{
var obj={token:Playbasis.env.global.token,player_id:playerId,device_token:deviceToken,device_description:deviceDescription,device_name:deviceName,os_type:osType};

return http.postJsonAsync(helpers.createApiUrl("Push/deviceRegistration"),obj);
};











api.deregisterDevice=function(playerId,deviceToken)
{
var obj={token:Playbasis.env.global.token,player_id:playerId,device_token:deviceToken};

return http.postJsonAsync(helpers.createApiUrl("Push/deviceDeRegistration"),obj);
};










api.sendPushNotification=function(playerId,message,templateId)
{
var obj={token:Playbasis.env.global.token,player_id:playerId,message:message,template_id:templateId};

return http.postJsonAsync(helpers.createApiUrl("Push/send"),obj);
};











api.sendPushNotificationCoupon=function(playerId,refId,message,templateId)
{
var obj={token:Playbasis.env.global.token,player_id:playerId,message:message,template_id:templateId};

return http.postJsonAsync(helpers.createApiUrl("Push/goods"),obj);
};













api.listRecentPushNotificationSent=function(playerId,options)
{
var keys=["player_id","since"];
var dvalues=[playerId,null];

return http.getJsonAsync(helpers.createApiUrl("Push/recent")+helpers.appendAndJoinIfNotNullAsUrlParam2(keys,dvalues,options));
};







api.listPushNotificationTemplate=function()
{
return http.getJsonAsync(helpers.createApiUrl("Push/template"));
};













api.getProcessedPushNotificationTemplate=function(templateId,options)
{
var keys=["player_id"];
var dvalues=[null];

return http.getJsonAsync(helpers.createApiUrl("Push/template",templateId)+helpers.appendAndJoinIfNotNullAsUrlParam2(keys,dvalues,options));
};
};